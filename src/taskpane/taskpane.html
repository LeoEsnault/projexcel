<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Importer un fichier CSV</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="./taskpane.js" defer></script>
    <script src="./filtre-tableau.js" defer></script>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="container">
      <h2 class="title">Importer un fichier CSV</h2>
      <div style="display: flex; flex-direction: row; justify-content: center;">
        <input type="file" id="fileInput" accept=".csv, .xlsx" style="width: 60vw; display: none" />
        <button id="fileButton">Choisir un fichier</button>
        <button id="importButton" class="btn primary-btn">Importer</button>
      </div>
      <div style="display: flex; flex-direction: column; align-items: center">
        <h3 style="text-align: center">Fichier en cours :</h3>
        <span id="fileName">Aucun fichier choisi</span>
      </div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator"></div>
      </div>
      <h3 class="subtitle" style="text-align: center; margin-bottom: 1.3em">
        Sélectionner les colonnes à insérer
      </h3>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator"></div>
      </div>
      <div id="checkboxContainer"></div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator"></div>
      </div>
      <h3 class="subtitle" style="text-align: center; margin-bottom: 1.5em;" id="rowSeparator">
        Sélectionner un filtre
      </h3>
      <div id="scrollRowValue" style="display: flex; justify-content: center; width: 90vw;">
        <div id="checkboxRow"></div>
      </div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator" id="Separator"></div>
      </div>
      <div style="width: 95vw; display: flex; justify-content: center;">
        <div style="display: flex; flex-direction: column; justify-content: space-evenly; width: 300px;">
          <button id="copyColumnButton" style="margin-right: 1em;" class="btn secondary-btn" disabled>
            Copier la sélection
          </button>
          <button id="copyTableButton" class="btn tertiary-btn" disabled style="margin-right: 1em;">
            Copier tout le tableau
          </button>
          <button id="deleteFiltre" class="btn-delete-filtre" disabled style="margin-right: 1em; margin-bottom: 0.5em;">
            Supprimer le filtre
          </button>
        </div>
      </div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator"></div>
      </div>
      <h3 class="subtitle" style="text-align: center; margin-bottom: 1em">Formule par colonne</h3>
      <div style="width: 95vw; display: flex; justify-content: center;">
        <div style="display: flex; flex-direction: column; justify-content: space-evenly; width: 300px; height: 100px;">
          <button id="moyenneByFilter" style="margin-right: 1em;  margin-bottom: 9px;" class="btn secondary-btn" disabled>
            Moyenne
          </button>
          <button id="additionByFilter" style="margin-right: 1em;" class="btn secondary-btn" disabled>
            Addition
          </button>
        </div>
      </div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator" id="separatorHistorique"></div>
      </div>
      <h3 style="text-align: center;">Historique</h3>
      <div id="scrollHistorique" style="display: flex; justify-content: center; width: 90vw;">
        <div id="checkboxMemoryParent"></div>
      </div>
      <div style="width: 90vw; justify-items: center;">
        <div class="separator"></div>
      </div>
      <h3 class="subtitle" style="text-align: center; margin-bottom: 5vh;">Appliquer un filtre sur un tableau</h3>
      <div style="display: flex; justify-content: center;">
        <input type="text" id="inputTableau" class="input-field" placeholder="Veuillez entrer le nom du tableau" style="width: 80vw; max-width: 450px;" />
      </div>
      <div style="display: flex; justify-content: center;">
        <button id="miseAJourTableau" class="btn primary-btn" style="margin-bottom: 1em; width: 300px;">
          Selectionner ce tableau
        </button>
      </div>
      <div id="checkboxContainerFiltre" style="margin-left: 5vw;"></div>
      <div style="display: flex; justify-content: center;">
        <input type="text" id="inputFiltre" class="input-field" placeholder="Veuillez entrer un élément à filtrer" style="width: 80vw; max-width: 450px;" />
      </div>
      <div style="display: flex; justify-content: center;">
        <div style="display: flex; justify-content: space-evenly; flex-direction: column; width: 300px;">
          <button type="button" id="filtreColumn" class="btn primary-btn">
            Appliquer le filtre
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
